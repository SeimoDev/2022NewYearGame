<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width,user-scalable=no" name="viewport">
    <title>注册</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
    <link rel="stylesheet" href="./argon.min.css" type="text/css">
</head>

<body onload="thetime=0;">
    <div class="main-content" id="panel">
        <div class="header bg-pink pb-6">
            <div class="container-fluid">
                <div class="header-body">
                    <div class="row align-items-center py-4">
                        <div class="col-lg-6 col-7">
                            <h6 class="h2 text-white d-inline-block mb-0">注册</h6>
                        </div>


                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>
    </div>
    <div class="container-fluid mt--6">
        <div class="row">
            <div class="col-xl-8 center">
                <div class="card">

                </div>
                <!-- 此处编写注册和协议逻辑 为什么要在这编写呢？我偏不！ -->
                <div class="card">
                    <div class="card-header">
                        <div style="text-align:center">
                            <h3 class="mb-0">注册账号</h3>
                        </div>
                    </div>
                    <div class="card-body" style="text-align:center">
                        <form>
                            <h5><input id="mail" type="text" autofocus required placeholder="请输入邮箱"></h5>
                            <input type="button" onclick="a()" value="获取验证码" class="col-auto btn btn-sm btn-success">
                            <h5><br><input id="surecode" type="text" required placeholder="请输入验证码"></h5>
                            <h5><input id="username" type="text" autofocus required placeholder="请输入用户名"></h5>
                            <h5><input id="password" type="password" required placeholder="请设置密码"></h5>
                            <h5><input id="surePassword" type="password" required placeholder="请再输入一次密码"></h5>
                            <input type="checkbox" name="tos">已阅读并同意<a href="index.html"> 用户协议</a><br>
                            <input type="button" name="submit" value="注册" class="col-auto btn btn-sm btn-success" onclick="
                
                            for (i = 0; i < form.length; i++) {
                                if (form.elements[i].value == '') {
                                    alert('请填写完整');
                                    return false;
                            }}
                            var scode = document.getElementById('surecode').value;
                            //document.cookie='scode='+scode;
                            document.cookie='code='+code;
                            if(scode == code){
                            document.cookie='username='+document.getElementById('username').value;
                            document.cookie='password='+document.getElementById('password').value;
                            document.cookie='mail='+document.getElementById('mail').value;
                            location.href='register.php';
                            
                            /*$.ajax({
                            url:'register.php',
                            type:'post',
                            data:{username:document.getElementById('username').value,password:document.getElementById('password').value,mail:document.getElementById('mail').value,code:document.getElementById('code').value},
                            success:function(result){
                                eval(result);
                            },
                            dataType :'text',
                        });*/
                            }else{
                            alert('验证码错误');
                            }
                            
                            "><br>

                            <a href="index.html">已有账号？点击登录！</a>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script src="./jquery.min.js"></script>
    <script>
        function a() {

            //alert("hh");
            var b = document.getElementById("mail").value;
            if (b == "") {
                alert("请输入邮箱");
            } else {
                if (Number(new Date()) - thetime >= 60000) {
                    thetime = Number(new Date());
                    code = Math.round(Math.random() * (999999 - 100000) + 100000);
                    $.ajax({
                        url: "mail.php",
                        type: "post",
                        data: {
                            email: document.getElementById("mail").value,
                            code: code
                        },
                        success: function(result) {
                            eval(result);
                        },
                        dataType: "text",
                    });
                } else {
                    alert("请在" + Math.round((60000 - Number(new Date()) + thetime) / 1000) + "秒后获取");
                }
            }

        }
    </script>

</body>
<footer>
    <div class="footer>" <div class="card">
        <div class="card-header" style="text-align:center">
            联系我们：seimo@sakura-bbs.cn
            <br> 官方鹅群：542645899
            <br>本游戏策划团队版权所有，遵循AGPL开源协议。游戏所有源码将于结束后开源，可关注B站@Seimo 或加入官方鹅群获取详情
        </div>
    </div>
</footer>

</html>